# Integrating SocialStreamNinja with Streamer.bot

This guide explains how to configure Streamer.bot to receive chat messages and events from SocialStreamNinja (or a similar application sending data in the specified format) using Streamer.bot's built-in HTTP Server. This allows you to trigger actions, control OBS, and use Streamer.bot's features based on multi-platform chat activity.

## Prerequisites

* **Streamer.bot:** Installed and running on your computer. Download from [streamer.bot](https://streamer.bot/).
* **SocialStream.Ninja:** Configured via the menu and running, with the ability to send HTTP POST requests to the Streamer.bot server.
* **Basic understanding** of Streamer.bot's interface (Actions, Servers/Clients tabs).

## Setup Steps

### Step 1: Enable Streamer.bot's HTTP Server

1.  Open Streamer.bot.
2.  Navigate to the **Servers/Clients** tab.
3.  Select the **HTTP Server** sub-tab.
4.  Ensure the server is **Enabled** (check the box) and **Started**. If not started, click `Start Server`. You might want to enable `Auto start` as well.
5.  **Note down the `Address` and `Port`**. The default is typically `127.0.0.1` and port `8080`. You'll need this for configuring SocialStreamNinja.
    * *Note:* `127.0.0.1` means only applications on the *same computer* can connect. If SocialStreamNinja runs elsewhere, you might need to bind to `0.0.0.0` (use with caution, consider network security/firewalls).
6.  (Optional) You can configure Authentication here if needed, but it's simpler to start without it.

### Step 2: Create a Streamer.bot Action to Handle Incoming Messages

This action will be triggered when SocialStreamNinja sends a message.

1.  Go to the **Actions** tab in Streamer.bot.
2.  Right-click in the Actions list pane and select **Add** (or click the `+ Add` button).
3.  Give the Action a descriptive **Name**, for example: `Handle SocialStream Chat`.
4.  Keep this action selected. Now, in the **Sub-Actions** pane (usually on the right):
    * Right-click and select **Add Sub-Action**.
    * Navigate to **Core** -> **Log Message**.
    * In the `Message` field, you can test receiving data using variables like this:
        ```
        [SocialStream] [%args[platform%]] %args[userName%]: %args[message%] (Moderator: %args[isModerator%])
        ```
        *(See the "Accessing Data" section below for available `%args%` variables)*.
    * Click **OK**.
5.  You can add more sub-actions here later to *do things* with the incoming data (e.g., `Core` -> `Set Argument`, `OBS` -> `Set Source Visibility`, `Core` -> `Action` -> `Run Action` to trigger other actions).

### Step 3: Create an HTTP Server Endpoint (Route)

This links a specific URL path to the Action you just created.

1.  Go back to the **Servers/Clients** -> **HTTP Server** tab.
2.  Select the **Endpoints** sub-tab below the server settings.
3.  Click the **Add** button (or right-click -> Add).
4.  Configure the Endpoint:
    * **Endpoint Path:** Choose a unique path for SocialStreamNinja messages. Example: `/socialstream/chat` or `/ssn/message`. **Make this path memorable - you need it in the next step!**
    * **HTTP Method:** Select **`POST`**.
    * **Enabled:** Make sure this is checked.
    * **Action:** Select the Action you created in Step 2 (e.g., `Handle SocialStream Chat`) from the dropdown list.
    * **Allowed Methods:** Should automatically reflect `POST`.
5.  Click **OK**.

### Step 4: Configure SocialStreamNinja (Your Application)

1.  Open the settings/configuration area of SocialStreamNinja where the Streamer.bot integration is handled.
2.  Find the setting for the **Streamer.bot Endpoint URL**. This corresponds to the `settings.streamerbotEndpointUrl.textsetting` in the JavaScript code.
3.  Enter the **full URL** constructed from:
    * `http://` (or `https://` if you configured SSL in Streamer.bot)
    * The **Address** noted in Step 1 (e.g., `127.0.0.1`)
    * `:` followed by the **Port** noted in Step 1 (e.g., `:8080`)
    * The **Endpoint Path** you chose in Step 3 (e.g., `/socialstream/chat`)
    * **Example Full URL:** `http://127.0.0.1:8080/socialstream/chat`
4.  Ensure the setting to **enable** sending messages to Streamer.bot is turned **ON**.
5.  Save the settings in SocialStreamNinja.

### Step 5: Test the Integration

1.  Make sure Streamer.bot is running with the HTTP Server active.
2.  Make sure SocialStreamNinja is running and configured with the correct endpoint URL.
3.  Have a chat message appear in SocialStreamNinja from any connected platform.
4.  Check the **Action Queues** -> **History** tab in Streamer.bot.
5.  You should see your `Handle SocialStream Chat` action being triggered.
6.  Double-click the entry in the History tab. In the window that appears, check the `Log` tab. You should see the message logged by the "Log Message" sub-action you added, containing data from the chat message.

## Accessing Data in Streamer.bot Actions

When SocialStreamNinja sends data, the fields are accessible within the triggered Streamer.bot Action via the `%args%` variable dictionary. Based on the provided JavaScript code, here are the primary variables you can use in your sub-actions:

* `%args[userName]%`: The user's display name (or bot name).
* `%args[userId]%`: The platform-specific user ID (or null).
* `%args[displayName]%`: User's display name.
* `%args[message]%`: The cleaned chat message content.
* `%args[platform]%`: The source platform (e.g., `twitch`, `youtube`, `socialstream`).
* `%args[userAvatarUrl]%`: URL to the user's avatar (or null).
* `%args[platformImageUrl]%`: URL to the platform icon.
* `%args[isModerator]%`: `True` or `False`.
* `%args[isAdmin]%`: `True` or `False`.
* `%args[isBot]%`: `True` or `False`.
* `%args[isQuestion]%`: `True` or `False`.
* `%args[isPrivate]%`: `True` or `False`.
* `%args[isTextOnly]%`: `True` or `False`.
* `%args[isEvent]%`: `True` (if it's any event) or the specific event type string, or `False`.
* `%args[eventType]%`: Specific event type string (e.g., `follow`, `sub`) or `null`.
* `%args[donationAmount]%`: Donation string (e.g., `$5 USD`, `3 roses`) or `null`.
* `%args[membershipInfo]%`: Membership details string or `null`.
* `%args[eventTitle]%`: Custom event title (e.g., `CHEERS`) or `null`.
* `%args[eventSubtitle]%`: Custom event subtitle (e.g., `5 months`) or `null`.
* `%args[contentImageUrl]%`: URL of associated image/video for the message or `null`.
* `%args[badges]%`: An array containing badge information (URLs or objects). You might need C# to easily process this array in detail, but you can log it: `%args[badges]%`.
* `%args[karmaScore]%`: Floating point number representing message sentiment (or null).
* `%args[internalMsgId]%`: Internal message ID number (or null).
* `%args[nameColor]%`: Custom name color CSS value (or null).
* `%args[textColor]%`: Custom text color CSS value (or null).
* `%args[backgroundColor]%`: Custom background color CSS value (or null).
* `%args[originalRawData]%`: The complete, original data object sent from SocialStreamNinja (useful for debugging or complex C# logic if needed later).

You can use these variables in most sub-action fields within your `Handle SocialStream Chat` action.

## Troubleshooting

* **Action Not Triggering:**
    * Verify the **Streamer.bot HTTP Server** is running (Step 1).
    * Double-check the **Full Endpoint URL** in SocialStreamNinja settings matches *exactly* the Address, Port, and Path configured in Streamer.bot (Step 4 vs Steps 1 & 3). Check for typos, missing `/`, `http` vs `https`.
    * Ensure the **Endpoint** in Streamer.bot is **Enabled** and linked to the correct **Action** (Step 3).
    * Check if a **Firewall** (Windows Firewall or other security software) is blocking connections to the port Streamer.bot is using (e.g., 8080). You may need to create an allow rule.
    * Check the Streamer.bot `Action Queues` -> `Errors` tab for any relevant errors.
    * Check the console/logs in SocialStreamNinja for network errors when it tries to send the message.
* **Data Not Appearing Correctly in Logs:**
    * Ensure the variable names in your `Log Message` sub-action (e.g., `%args[userName]%`) match the keys listed in the "Accessing Data" section. Case sensitivity might matter depending on the Streamer.bot version.
    * Log the raw args to see what's arriving: add a Log sub-action with just `%args%`.
* **Error 401 Unauthorized (If using Auth):**
    * Make sure the username/password or token configured in Streamer.bot's HTTP Server Authentication matches what SocialStreamNinja is sending (if the JS code was modified to send authentication headers).

By following these steps, you should have a robust connection sending chat data from SocialStreamNinja directly into Streamer.bot actions!